##  Diagramas de Arquitetura (Revisados para o MVP)

### 1. Diagrama de Contexto – FinSimples (MVP)
- **Sistema Central**  
  - **FinSimples – Assistente de Previsão de Retorno** — recebe **ticker** e **período (1–5 anos)** e retorna **card** com projeção, contexto e riscos.
- **Atores (Usuários)**  
  - **Investidor** — *[Implementado]*: envia ticker+período pelo frontend e recebe o card.
  - **Parceiro/Corretora** — *[Planejado]*: consumirá a **API pública** para integração.
- **Sistemas Externos**  
  - **yfinance** — *[Implementado]*: provê séries históricas e cotações.
  - **OpenAI (ChatGPT)** — *[Implementado]*: gera narrativa simplificada (sem jargões).
  - **bravi.dev** — *[Implementado]*: **deploy/observabilidade**.
  - **APIs B3** — *[Planejado]*: enriquecimento de dados.

### 2 Diagrama de Contêiner
- **Frontend (Next.js)** — *[Implementado]*  
  UI web/mobile para input e exibição do card.  
  **Tecnologia:** Next.js.  
  **Interação:** chama a API de Previsão.

- **API de Previsão (FastAPI)** — *[Implementado]*  
  Valida input, orquestra chamadas a dados e LLM, formata resposta.  
  **Tecnologia:** Python, FastAPI.  
  **Interação:** recebe requisições do Frontend e (futuro) Parceiros.

- **Serviço de Projeção (Estatístico)** — *[Implementado]*  
  Coleta dados do yfinance, calcula métricas (retornos históricos, média/volatilidade, CAGR simples) e gera projeção base.  
  **Tecnologia:** Python, pandas/numpy.

- **Serviço de Narrativa (LLM Orchestrator)** — *[Implementado]*  
  Monta prompt com projeção base e chama ChatGPT para gerar texto amigável.  
  **Tecnologia:** Python (cliente OpenAI).

- **Cache (memória/Redis)** — *[Planejado]*  
  Reduz latência de ~60s com cache de cotações, indicadores e respostas LLM.  
  **Tecnologia:** In-memory/Redis.

- **Data Lake (Parquet/S3)** — *[Planejado]*  
  Armazenar séries históricas em Parquet.

- **Model Store (S3/local)** — *[Planejado]*  
  Guardar modelos/pipelines quando houver ML supervisionado.

- **Scheduler (Cron/Airflow)** — *[Planejado]*  
  Retraining e limpeza de artefatos.

### 3 Diagrama de Componentes — Serviço de Projeção (MVP)
- **DataFetcher (yfinance)** — *[Implementado]*: baixa e valida séries.
- **Preprocessor** — *[Implementado]*: ordena por data, trata faltas/outliers simples.
- **ProjectionEngine (baseline)** — *[Implementado]*: retorna projeção feita pelo modelo de Machine Learning treinado baseado em series históricas.  
- **RiskScorer** — *[Implementado]*: bullets de riscos (volatilidade, liquidez, concentração setorial).
- **NarrativeBuilder (LLM)** — *[Implementado]*: prompt → ChatGPT → texto sem jargões, sem call de compra/venda.
- **CacheMiddleware** — *[Planejado]*: cache de dados/indicadores/respostas para reduzir TTV.

### 4 Notas de Aderência ao MVP
- **API para Parceiros**, **Data Lake**, **Model Store** e **Scheduler** estão **planejados**.
- Ainda não há pipeline de ML supervisionado com retraining automático.
