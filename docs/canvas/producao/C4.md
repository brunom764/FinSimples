## Diagrama de Contexto para FinSimples

- **Sistema Central**  
  - **FinSimples – Assistente de Previsão de Retorno**  
    Sistema principal que recebe códigos de ativos e períodos e retorna projeções de retorno do periodo escolhido pelo usuario.

- **Atores (Usuários)**  
  - **Investidor**  
    - **Interação**: Envia o CÓDIGO e o PERÍODO escolhido via frontend e recebe card com retorno projetado, riscos e detalhes sobre o investimento escolhido.  

- **Atores (Sistemas Externos)**  
  - **bravi.dev**  
    - **Interação**: Fornece séries históricas para o DataLoader.  
  - **Corretora / Parceiro**  
    - **Interação**: Consome a API REST de previsão em JSON para integrar em plataformas de trading.  

---

## Diagrama de Contêiner para FinSimples

- **Contêiner 1: Frontend (Next.js)**  
  - **Função**: Interface de usuário móvel/web para inserção de ativo + período e exibição de resultados.  
  - **Tecnologia**: Next.js, React, Tailwind CSS.  
  - **Interação**: Chama a API de Previsão.

- **Contêiner 2: API de Previsão (FastAPI)**  
  - **Função**: Orquestra fluxos — valida input, delega ao ML Service, formata resposta.  
  - **Tecnologia**: Python, FastAPI, Pydantic.  
  - **Interação**: Recebe requisições do Frontend e da Corretora; encaminha para Serviço de ML.

- **Contêiner 3: Serviço de ML**  
  - **Função**: Pré‑processa, modela e faz inferência de modelos de retorno de ativos.  
  - **Tecnologia**: Python, scikit‑learn, joblib.  
  - **Interação**: Lê dados do Data Lake e grava modelos no Model Store; responde à API de Previsão.

- **Contêiner 4: Data Lake (Parquet/S3)**  
  - **Função**: Armazena séries históricas comprimidas em Parquet.  
  - **Tecnologia**: PyArrow, AWS S3 (ou filesystem local).  
  - **Interação**: Lido pelo DataLoader no Serviço de ML.

- **Contêiner 5: Model Store (S3/API)**  
  - **Função**: Persiste pipelines treinados (`.joblib`) para uso em inferência.  
  - **Tecnologia**: joblib, AWS S3 (ou storage local).  
  - **Interação**: Escrita pelo Serviço de ML após treino; leitura pelo Predictor.

- **Contêiner 6: Scheduler (Cron/Airflow)**  
  - **Função**: Agenda retraining periódico e cleanup de modelos antigos.  
  - **Tecnologia**: Cron jobs ou Apache Airflow.  
  - **Interação**: Dispara rotinas de treino no Serviço de ML.

---

## Diagrama de Componentes para o Serviço de ML

- **Componente 1: DataLoader**  
  - **Função**: `load_data()` — lê Parquet, converte `date` em datetime e ordena por ticker/data.  
  - **Tecnologia**: pandas, pyarrow.

- **Componente 2: FeatureEngineering**  
  - **Função**: `engineer_features()` — calcula retorno diário, lags, SMA5, volatilidade5 e target.  
  - **Tecnologia**: pandas, numpy.

- **Componente 3: ModelTrainer**  
  - **Função**: `train_and_evaluate()` — constrói pipeline (Scaler + RandomForest), faz GridSearchCV e avalia.  
  - **Tecnologia**: scikit‑learn.

- **Componente 4: Predictor**  
  - **Função**: `predict()` — carrega modelo serializado, aplica em novo batch de dados para gerar previsões em tempo real.  
  - **Tecnologia**: joblib, scikit‑learn.

- **Componente 5: ModelPersister**  
  - **Função**: `save_model()` — serializa e grava pipeline treinado no Model Store.  
  - **Tecnologia**: joblib, boto3 (S3) ou filesystem.
